import{u as O}from"./record-C_G8p5eG.js";import{k as _,l as R,m as F,p as N,f as d,q as P,v as M,d as V,j as z,r as k,s as D,i as p,e as v,a as i,x as E,c as I,y as S,u as B,F as L,z as U,o as u,t as f,n as Y,b as q,h as A,_ as H}from"./index-DsoT5AaN.js";let g;const W={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,destroyOnClose:!1};let j=_({},W);function Q(){({instance:g}=F({setup(){const{state:s,toggle:r}=N();return()=>d(M,P(s,{"onUpdate:show":r}),null)}}))}function G(c){return R?new Promise((s,r)=>{g||Q(),g.open(_({},j,c,{callback:a=>{(a==="confirm"?s:r)(a)}}))}):Promise.resolve(void 0)}const J=c=>G(_({showCancelButton:!0},c)),K={class:"record-page"},X={class:"p-[16px] flex-1 overflow-y-auto"},Z={class:"record-main"},ee={class:"record-time"},te={key:0,class:"record-remark"},ne=V({__name:"Record",setup(c){const s=O(),r=k(!1),a=k(null),b=E(()=>{if(!a.value)return"";const[t,e]=a.value;return`${w(t)} - ${w(e)}`});z(()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1),o=new Date;a.value=[e,o],h()});function w(t){const e=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${e}-${o}-${l}`}function $(t){const e=new Date(t),o=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),m=String(e.getDate()).padStart(2,"0"),y=["周日","周一","周二","周三","周四","周五","周六"][e.getDay()];return`${o}-${l}-${m} ${y}`}function T(t){a.value=t,r.value=!1,h()}async function h(){if(!a.value)return;const[t,e]=a.value,o=new Date(e);o.setHours(23,59,59,999);const l={startTime:t.getTime(),endTime:o.getTime()};try{await s.queryRecords(l)}catch{D("查询失败")}}async function x(t){try{await J({title:"确认删除",message:"确定要删除这条记录吗？"}),await s.deleteRecord(t),D("删除成功")}catch{}}return(t,e)=>{const o=i("van-nav-bar"),l=i("van-field"),m=i("van-empty"),C=i("van-button"),y=i("van-calendar");return u(),p("div",K,[d(o,{title:"历史记录","left-arrow":"",onClickLeft:e[0]||(e[0]=n=>t.$router.back())}),d(l,{"model-value":b.value,label:"日期区间",placeholder:"请选择日期区间","is-link":"",readonly:"",onClick:e[1]||(e[1]=n=>r.value=!0)},null,8,["model-value"]),v("div",X,[B(s).records.length===0?(u(),I(m,{key:0,description:"暂无记录"})):S("",!0),(u(!0),p(L,null,U(B(s).records,n=>(u(),p("div",{key:n.id,class:"record-item"},[v("div",Z,[v("div",ee,f($(n.time)),1),v("div",{class:Y(["record-amount",{"amount-positive":n.amount>=0,"amount-negative":n.amount<0}])},f(n.amount>0?"+":"")+f(n.amount),3),n.remark?(u(),p("div",te,f(n.remark),1)):S("",!0)]),d(C,{plain:"",round:"",type:"danger",size:"small",onClick:oe=>x(n.id)},{default:q(()=>[...e[3]||(e[3]=[A(" 删除 ",-1)])]),_:1},8,["onClick"])]))),128))]),d(y,{show:r.value,"onUpdate:show":e[2]||(e[2]=n=>r.value=n),type:"range","allow-same-day":!0,onConfirm:T},null,8,["show"])])}}}),re=H(ne,[["__scopeId","data-v-3c92007c"]]);export{re as default};
