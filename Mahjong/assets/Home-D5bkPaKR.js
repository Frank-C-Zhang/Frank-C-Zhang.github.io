import{u as A}from"./record-DnbUToij.js";import{d as h,r as k,w as T,c as q,a as u,b as l,o as $,e as i,f as t,g as E,h as x,u as v,s as S,i as D,t as C,n as Y,_ as M,j as G}from"./index-zjdySfHU.js";const J={class:"h-[100%] flex flex-col"},K={class:"flex-1"},L={class:"flex-1"},O={class:"px-[16px]"},P=h({__name:"AddModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(f,{emit:d}){const c=f,s=d,b=A(),a=k(c.modelValue),m=k(!1),V=new Date(2e3,0,1),o=E({dateText:"",amount:0,remark:"",type:"win"}),y=()=>{const n=new Date;o.dateText=p(n),o.type="win"},p=n=>{const e=n.getFullYear(),_=String(n.getMonth()+1).padStart(2,"0"),g=String(n.getDate()).padStart(2,"0");return`${e}-${_}-${g}`};T(()=>c.modelValue,n=>{a.value=n,n&&y()}),T(a,n=>{s("update:modelValue",n),n||B()});const U=n=>{Array.isArray(n)?o.dateText=p(n[0]):o.dateText=p(n),m.value=!1},z=async()=>{try{const n=new Date(o.dateText+" 00:00:00").getTime(),e=o.type==="win"?Math.abs(o.amount):-Math.abs(o.amount);await b.addRecord(n,e,o.remark),S("保存成功"),s("success"),a.value=!1}catch(n){S("保存失败"),console.error("保存失败:",n)}},B=()=>{o.dateText="",o.amount=0,o.remark="",o.type="win"};return(n,e)=>{const _=u("van-field"),g=u("van-radio"),R=u("van-radio-group"),I=u("van-divider"),F=u("van-button"),N=u("van-form"),H=u("van-calendar"),j=u("van-popup");return $(),q(j,{show:a.value,"onUpdate:show":e[6]||(e[6]=r=>a.value=r),position:"bottom",style:{height:"60%"},closeable:"",round:"","close-icon-popover":"","safe-area-inset-bottom":""},{default:l(()=>[i("div",J,[e[10]||(e[10]=i("div",{class:"text-center leading-[55px] font-bold border border-b-gray-100"},"新增记录",-1)),i("div",K,[t(N,{onSubmit:z,ref:"formRef",class:"flex flex-col h-[100%]"},{default:l(()=>[i("div",L,[t(_,{modelValue:o.dateText,"onUpdate:modelValue":e[0]||(e[0]=r=>o.dateText=r),name:"date",label:"日期",placeholder:"请选择日期","is-link":"",readonly:"",onClick:e[1]||(e[1]=r=>m.value=!0)},null,8,["modelValue"]),t(_,{name:"type",label:"类型"},{input:l(()=>[t(R,{modelValue:o.type,"onUpdate:modelValue":e[2]||(e[2]=r=>o.type=r),direction:"horizontal"},{default:l(()=>[t(g,{name:"win"},{default:l(()=>[...e[7]||(e[7]=[x("赢",-1)])]),_:1}),t(g,{name:"lose"},{default:l(()=>[...e[8]||(e[8]=[x("输",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{modelValue:o.amount,"onUpdate:modelValue":e[3]||(e[3]=r=>o.amount=r),modelModifiers:{number:!0},name:"amount",label:"金额",type:"number",placeholder:"请输入金额",rules:[{required:!0,message:"请输入金额"}]},null,8,["modelValue"]),t(_,{modelValue:o.remark,"onUpdate:modelValue":e[4]||(e[4]=r=>o.remark=r),name:"remark",label:"备注",type:"textarea",placeholder:"请输入备注（可选）",rows:"2",maxlength:"200","show-word-limit":""},null,8,["modelValue"]),t(I,{style:{display:"none"}})]),i("div",O,[t(F,{round:"",block:"",type:"primary","native-type":"submit",class:"confirm-button"},{default:l(()=>[...e[9]||(e[9]=[x(" 确定 ",-1)])]),_:1})])]),_:1},512)])]),t(H,{show:m.value,"onUpdate:show":e[5]||(e[5]=r=>m.value=r),type:"single","min-date":v(V),poppable:!0,"show-confirm":!0,"safe-area-inset-bottom":!0,onConfirm:U},null,8,["show","min-date"])]),_:1},8,["show"])}}}),Q={class:"total-item"},W={class:"stat-title"},X=h({__name:"TotalItem",props:{amount:{},text:{}},setup(f){const d=s=>s===0?"0.00":(s>0?"+":"")+s.toFixed(2),c=s=>s>0?"amount-positive":s<0?"amount-negative":"amount-zero";return(s,b)=>($(),D("div",Q,[i("div",W,C(f.text),1),i("div",{class:Y(["stat-amount",c(f.amount)])},C(d(f.amount)),3)]))}}),w=M(X,[["__scopeId","data-v-cff10944"]]),Z={class:"home"},ee={class:"stats-container"},te={class:"action-buttons"},oe=h({__name:"Home",setup(f){const d=A(),c=k(!1);G(()=>{d.loadRecords()});const s=()=>{d.loadRecords()};return(b,a)=>{const m=u("van-grid-item"),V=u("van-grid"),o=u("van-icon"),y=u("van-button");return $(),D("div",Z,[t(P,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=p=>c.value=p),onSuccess:s},null,8,["modelValue"]),i("div",ee,[t(V,{"column-num":2,border:!1,gutter:10},{default:l(()=>[t(m,null,{default:l(()=>[t(w,{amount:v(d).calculateAmount("year"),text:"本年"},null,8,["amount"])]),_:1}),t(m,null,{default:l(()=>[t(w,{amount:v(d).calculateAmount("month"),text:"本月"},null,8,["amount"])]),_:1}),t(m,null,{default:l(()=>[t(w,{amount:v(d).calculateAmount("week"),text:"本周"},null,8,["amount"])]),_:1}),t(m,null,{default:l(()=>[t(w,{amount:v(d).calculateAmount("lastMonth"),text:"上月"},null,8,["amount"])]),_:1})]),_:1})]),i("div",te,[t(y,{round:"",type:"primary",size:"large",onClick:a[1]||(a[1]=p=>c.value=!0)},{default:l(()=>[t(o,{name:"plus"}),a[3]||(a[3]=x(" 新增记录 ",-1))]),_:1}),t(y,{round:"",type:"default",size:"large",onClick:a[2]||(a[2]=p=>b.$router.push("/record"))},{default:l(()=>[t(o,{name:"bars"}),a[4]||(a[4]=x(" 历史记录 ",-1))]),_:1})])])}}}),le=M(oe,[["__scopeId","data-v-ca45f60a"]]);export{le as default};
